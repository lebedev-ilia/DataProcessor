version: "bench_spec_v1"

# Local implemented baseline GPU branches (NO dynamic axes, batch=1).
# Includes fixed-shape branches for CLIP (224/336/448) and Places365 (224/336/448).
# NOTE (6GB GPUs): running all models sequentially may trigger ORT CUDA OOM for later models.
# Use grouped specs (or 6GB spec): `benchmarks/specs/baseline_gpu_local_6gb.yaml`.

defaults:
  warmup: 5
  repeats: 30
  timeout_sec: 10.0

models:
  # --- CLIP image (implemented) ---
  - name: clip_image_224
    model_spec_name: clip_image_224_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 224, 224, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: clip_image_336
    model_spec_name: clip_image_336_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 336, 336, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: clip_image_448
    model_spec_name: clip_image_448_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 448, 448, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  # --- CLIP text (implemented; output shape differs but datatype+name match) ---
  - name: clip_text
    model_spec_name: clip_text_triton
    kind: single_input
    input:
      dtype: INT64
      shape: [1, 77]
      layout: tokens
      value: random_int
      int_range: [0, 49408]
    output:
      name: OUTPUT__0

  # --- Places365 (scene classification) ---
  - name: places365_resnet50_224
    model_spec_name: places365_resnet50_224_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 224, 224, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: places365_resnet50_336
    model_spec_name: places365_resnet50_336_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 336, 336, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: places365_resnet50_448
    model_spec_name: places365_resnet50_448_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 448, 448, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  # --- MiDaS depth branches ---
  - name: midas_256
    model_spec_name: midas_256_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 256, 256, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: midas_384
    model_spec_name: midas_384_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 384, 384, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: midas_512
    model_spec_name: midas_512_triton
    kind: single_input
    input:
      dtype: UINT8
      shape: [1, 512, 512, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  # --- RAFT optical flow branches ---
  - name: raft_256
    model_spec_name: raft_256_triton
    kind: two_inputs
    input0:
      dtype: UINT8
      shape: [1, 256, 256, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    input1:
      dtype: UINT8
      shape: [1, 256, 256, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: raft_384
    model_spec_name: raft_384_triton
    kind: two_inputs
    input0:
      dtype: UINT8
      shape: [1, 384, 384, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    input1:
      dtype: UINT8
      shape: [1, 384, 384, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  - name: raft_512
    model_spec_name: raft_512_triton
    kind: two_inputs
    input0:
      dtype: UINT8
      shape: [1, 512, 512, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    input1:
      dtype: UINT8
      shape: [1, 512, 512, 3]
      layout: nhwc
      value: random_int
      int_range: [0, 256]
    output:
      name: OUTPUT__0

  # --- YOLO11x branches (object detections) ---
  - name: yolo11x_320
    model_spec_name: yolo11x_320_triton
    kind: single_input
    input:
      dtype: FP32
      shape: [1, 3, 320, 320]   # NCHW (after letterbox+norm)
      layout: nchw
      value: random_uniform
      float_range: [0.0, 1.0]
    output:
      name: output0

  - name: yolo11x_640
    model_spec_name: yolo11x_640_triton
    kind: single_input
    input:
      dtype: FP32
      shape: [1, 3, 640, 640]
      layout: nchw
      value: random_uniform
      float_range: [0.0, 1.0]
    output:
      name: output0

  - name: yolo11x_960
    model_spec_name: yolo11x_960_triton
    kind: single_input
    input:
      dtype: FP32
      shape: [1, 3, 960, 960]
      layout: nchw
      value: random_uniform
      float_range: [0.0, 1.0]
    output:
      name: output0


